# ESPHome firmware template for CREE C/W Bulb
# 
# initial code taken from
# https://github.com/esphome/issues/issues/3487
# Analysis from:
# https://github.com/arendst/Tasmota/issues/6914

substitutions:
  api_key: "Change me"
  # Required import substitutions
  device_site: "home"
  device_location_code: "changeme"
  device_location_name: "Change Me"
  device_type_code: "changeme"
  device_type_name: "Change Me"
  device_number: "000"
  device_ip: "0.0.0.0"

  disable_entities: "true"
  disable_webserver: "false"
  
  sub_cw_pin: GPIO26
  sub_ww_pin: GPIO24
  sub_adc_pin: GPIO23
  
  sub_warm_white_temp: 2800 Kelvin
  sub_cold_white_temp: 6600 Kelvin

  sub_cw_freq: 400hz
  sub_ww_freq: 400hz

  sub_reboot_req: '9'
  sub_ota_num_attempts: '15'

  sub_max_power: '0.8'
  sub_default_transition_length: 250ms
  sub_api_reboot_timeout: 0s
  light_restore_mode: RESTORE_DEFAULT_ON

  # Project Substitutions (not intended for user substitutions)
  package_url: "github://Marsupilami23/myesphometemplates/kauf-rgbww-bulbs.yaml@main"

# Allow importing this package
dashboard_import:
  package_import_url: "${package_url}"
  import_full_config: false

# https://esphome.io/components/external_components.html
external_components:
  - source:
      type: git
      url: https://github.com/KaufHA/common
      ref: v2024.11.20
    refresh: never
  - source:
      type: git
      url: https://github.com/KaufHA/kauf-rgbww-bulbs
    refresh: always

# Import packages:
packages:
  standard_packages:
    url: https://github.com/Marsupilami23/myesphometemplates/
    ref: main
    refresh: always
    files:
      - kauf-rgbww-bulbs/standard/project.yaml
      - kauf-rgbww-bulbs/standard/diagnostics.yaml
      - kauf-rgbww-bulbs/standard/wifi.yaml
  cree_st19_packages:
    url: https://github.com/Marsupilami23/myesphometemplates/
    ref: main
    refresh: always
    files:
      - kauf-rgbww-bulbs/board.yaml
      - kauf-rgbww-bulbs/current-sensor.yaml
      - kauf-rgbww-bulbs/pwm-outputs.yaml

light:
  - platform: monochromatic
    name: "Cold White"
    id: cw_light
    output: pwm_cw_output

  - platform: monochromatic
    name: "Warm White"
    id: ww_light
    output: pwm_ww_output
