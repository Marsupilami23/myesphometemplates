text_sensor:
  - platform: wifi_info
    ip_address:
      name: "${device_name} IP Address"
      entity_category: diagnostic
      disabled_by_default: "${disable_entities}"

  - platform: template
    name: "Current Time"
    id: current_time
    update_interval: never
    device_class: timestamp
    icon: "mdi:calendar-clock"
    entity_category: sensor
    lambda: |-
      char current_time_str[32];
      time_t currTime = id(

            - mqtt.publish:
          topic: homeassistant/${device_code}/sensor/current_time
          payload: !lambda |
            time_t currTime = id(homeassistant_time).now().timestamp;
            char current_time_str[17];
            strftime(current_time_str, sizeof(current_time_str), "%Y-%m-%d %H:%M", localtime(&currTime));
            return std::string(current_time_str);
